
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Storyboard</title>
  <link rel="stylesheet" href="storyboard.css" />
</head>
<body>
  <h2>Story Scene: The Tortoise and The Hare</h2>

  <div class="scene-wrapper">
    <!-- Background sized the same as character-select -->
    <img src="images/colored-background2.png" id="scene" alt="Scene">

    <!-- Animated GIFs (must match your actual filenames/paths) -->
    <img src="images/gifs/hare.gif"      class="character hare"      alt="Hare"      draggable="false">
    <img src="images/gifs/tortoise.gif"  class="character tortoise"  alt="Tortoise"  draggable="false">
    <img src="images/gifs/bear.gif"      class="character bear"      alt="Bear"      draggable="false">
    <img src="images/gifs/squirrel.gif"  class="character squirrel"  alt="Squirrel"  draggable="false">
    <img src="images/gifs/bird1.gif"     class="character bird1"     alt="Bird 1"    draggable="false">
    <img src="images/gifs/bird2.gif"     class="character bird2"     alt="Bird 2"    draggable="false">
  </div>
  
  <script type="module">
  import { colorCharacterFrames } from './js/color-map-advanced.js';

  (async () => {
    const masked = localStorage.getItem('coloredCharacter'); // from canvas.js
    const char = (localStorage.getItem('selectedCharacter') || 'tortoise').toLowerCase();

    // Build 4 colorized frames from the student's masked drawing
    const frames = await colorCharacterFrames({
      character: char,
      maskedBaseDataURL: masked
    });

    // Find or create the character <img> node
    const node = document.querySelector(`.character.${char}`);
    if (!node) return; // safety if no matching node exists

    // Animate by cycling through frames
    let i = 0;
    setInterval(() => {
      node.src = frames[i].dataURL;
      i = (i + 1) % frames.length;
    }, 250); // ~4fps
  })();
</script>

</body>
</html>
